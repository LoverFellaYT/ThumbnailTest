<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StoryCraft Analyzer - Plan Viral Videos</title>
    <meta name="description" content="Review and enhance your YouTube and Roblox video concepts before recording with StoryCraft Analyzer!" />
    <meta name="keywords" content="StoryCraft, YouTube, Roblox, video planning, story analyzer" />
    <meta name="author" content="loverfellayt" />
    <link rel="icon" href="https://via.placeholder.com/32" type="image/x-icon" />

    <!-- External Libraries -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnH/PRRZ9i6Lkxy/lK+Ad+Qw3PweIIsXgTn5N2sA3ZgP6L6YKn42pPZLNSQNkI3b7HlFj5pAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />

    <!-- CSS Styles -->
    <style>
      :root {
        --primary-light: #4facfe;
        --accent-light: #00f2fe;
        --bg-light: #f9fafb;
        --text-light: #1e293b;
        --panel-light: rgba(255, 255, 255, 0.96);
        --border-light: rgba(255, 255, 255, 0.2);
        --shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
        --transition: all 0.2s ease;
        --radius: 16px;
        --gradient-light: linear-gradient(135deg, var(--primary-light) 0%, var(--accent-light) 100%);
        --spacing: 1.5rem;
        --font-base: 'Poppins', sans-serif;
        --highlight: #ff6b6b;
      }
      html[data-theme="dark"] {
        --bg-light: #1f1f1f;
        --text-light: #f3f3f3;
        --panel-light: rgba(18, 18, 18, 0.98);
        --border-light: rgba(255, 255, 255, 0.2);
        --gradient-light: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      }

      body {
        margin: 0;
        padding: 0;
        font-family: var(--font-base);
        background: var(--bg-light);
        color: var(--text-light);
        line-height: 1.6;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }

      .hero {
        text-align: center;
        padding: 3rem 1rem;
        background: var(--gradient-light);
        color: #fff;
        border-radius: 0 0 var(--radius) var(--radius);
        box-shadow: var(--shadow);
      }
      .hero h1 {
        font-size: clamp(2rem, 5vw, 2.8rem);
        margin: 0;
        font-weight: 700;
      }
      .hero p {
        font-size: clamp(1rem, 3vw, 1.3rem);
        margin: 0.5rem 0 1rem;
      }

      nav {
        display: flex;
        justify-content: space-around;
        flex-wrap: wrap;
        gap: 1rem;
        margin: var(--spacing) 0;
      }
      nav button {
        background: var(--panel-light);
        border: 2px solid var(--border-light);
        padding: 0.8rem 1.5rem;
        border-radius: var(--radius);
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
      }
      nav button.active, nav button:hover {
        background: var(--gradient-light);
        color: #fff;
      }

      .tab {
        display: none;
      }
      .tab.active {
        display: block;
      }

      .glass-panel {
        background: var(--panel-light);
        border: 2px solid var(--border-light);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        backdrop-filter: blur(12px);
        padding: 2rem;
        margin: var(--spacing) 0;
      }
      .glass-panel h2 {
        color: var(--highlight);
        font-size: clamp(1.4rem, 4vw, 1.8rem);
        margin-top: 0;
      }

      .story-input {
        width: 100%;
        min-height: 150px;
        padding: 1rem;
        border: 2px solid var(--border-light);
        border-radius: var(--radius);
        font-size: 1rem;
        background: var(--bg-light);
        resize: vertical;
        transition: var(--transition);
        color: var(--text-light);
      }
      html[data-theme="dark"] .story-input {
        color: #fff;
      }
      .story-input:focus {
        border-color: var(--primary-light);
        box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.2);
        outline: none;
      }

      .rubric-table {
        width: 100%;
        overflow-x: auto;
      }
      .modern-table {
        width: 100%;
        min-width: clamp(600px, 100vw, 900px);
        border-collapse: separate;
        border-spacing: 0;
        border-radius: var(--radius);
        overflow: hidden;
        box-shadow: var(--shadow);
      }
      .modern-table th, .modern-table td {
        padding: 1rem 1.5rem;
        font-size: 0.9rem;
      }
      .modern-table th {
        background: var(--gradient-light);
        color: #fff;
      }
      .modern-table th:nth-child(2) { background: #f87171; }
      .modern-table th:nth-child(3) { background: #fb923c; }
      .modern-table th:nth-child(4) { background: #facc15; color: #000; }
      .modern-table th:nth-child(5) { background: #4ade80; }
      .modern-table td[data-rating] {
        cursor: pointer;
        transition: background 0.2s;
      }
      .modern-table td[data-rating]:hover, .modern-table td[data-rating]:focus {
        background: rgba(79, 172, 254, 0.2);
      }
      .modern-table td.selected {
        background: rgba(224, 231, 255, 0.5);
        border-left: 4px solid var(--primary-light);
        animation: pulse 0.3s ease;
      }
      @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

      #feedbackOutput, #plannerList {
        text-align: left;
        margin-top: 1rem;
      }
      #feedbackOutput ul, #plannerList ul {
        list-style-type: disc;
        padding-left: 2rem;
      }

      button.btn {
        background: var(--gradient-light);
        color: #fff;
        border: none;
        padding: 0.7rem 1.5rem;
        border-radius: var(--radius);
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
        margin-top: 1rem;
      }
      button.btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(126, 34, 206, 0.4);
      }

      footer {
        text-align: center;
        padding: var(--spacing);
        font-size: 0.9rem;
        color: #64748b;
      }
      footer a {
        color: var(--primary-light);
        text-decoration: none;
      }
      footer a:hover {
        text-decoration: underline;
      }

      #toast {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--primary-light);
        color: #fff;
        padding: 1rem;
        border-radius: 8px;
        display: none;
        z-index: 1000;
      }

      @media (max-width: 768px) {
        .modern-table th, .modern-table td {
          padding: 0.8rem;
          font-size: 0.85rem;
        }
        nav {
          flex-direction: column;
          align-items: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Hero Section -->
      <section class="hero">
        <h1>StoryCraft Analyzer</h1>
        <p>Plan and enhance your YouTube & Roblox video concepts before recording!</p>
      </section>

      <!-- Workflow Tabs -->
      <nav>
        <button id="tab-concept" class="active" onclick="showTab('concept')">1. Concept</button>
        <button id="tab-score" onclick="showTab('score')">2. Score</button>
        <button id="tab-feedback" onclick="showTab('feedback')">3. Feedback</button>
        <button id="tab-plan" onclick="showTab('plan')">4. Plan</button>
      </nav>

      <!-- Main Content -->
      <main>
        <!-- Concept Input -->
        <section id="concept" class="tab glass-panel active">
          <h2>üìù Video Concept</h2>
          <textarea id="quickSummary" class="story-input" placeholder="Include your hook, conflict, and goal (e.g., 'I hatch 1000 eggs in Pet Simulator 99 to find a legendary pet, racing against a server crash')"></textarea>
          <p>Word count: <span id="wordCount">0</span></p>
          <button class="btn" onclick="showTab('score')">Next: Score Your Idea</button>
        </section>

        <!-- Scoring -->
        <section id="score" class="tab glass-panel">
          <h2>üìä Score Your Idea</h2>
          <div class="rubric-table">
            <table class="modern-table">
              <thead>
                <tr>
                  <th>Category</th>
                  <th>Good (1)</th>
                  <th>Great (2)</th>
                  <th>Excellent (3)</th>
                  <th>Outstanding (4)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>üé£ Hook</td>
                  <td data-category="0" data-rating="1" tabindex="0" role="button" aria-label="Rate Hook as Good">Slow</td>
                  <td data-category="0" data-rating="2" tabindex="0" role="button" aria-label="Rate Hook as Great">Functional</td>
                  <td data-category="0" data-rating="3" tabindex="0" role="button" aria-label="Rate Hook as Excellent">Intriguing</td>
                  <td data-category="0" data-rating="4" tabindex="0" role="button" aria-label="Rate Hook as Outstanding">Unignorable</td>
                </tr>
                <tr>
                  <td>üéØ Goal</td>
                  <td data-category="1" data-rating="1" tabindex="0" role="button" aria-label="Rate Goal as Good">Vague</td>
                  <td data-category="1" data-rating="2" tabindex="0" role="button" aria-label="Rate Goal as Great">Muddled</td>
                  <td data-category="1" data-rating="3" tabindex="0" role="button" aria-label="Rate Goal as Excellent">Defined</td>
                  <td data-category="1" data-rating="4" tabindex="0" role="button" aria-label="Rate Goal as Outstanding">Crystal-clear</td>
                </tr>
                <tr>
                  <td>‚öîÔ∏è Conflict</td>
                  <td data-category="2" data-rating="1" tabindex="0" role="button" aria-label="Rate Conflict as Good">Trivial</td>
                  <td data-category="2" data-rating="2" tabindex="0" role="button" aria-label="Rate Conflict as Great">Predictable</td>
                  <td data-category="2" data-rating="3" tabindex="0" role="button" aria-label="Rate Conflict as Excellent">Engaging</td>
                  <td data-category="2" data-rating="4" tabindex="0" role="button" aria-label="Rate Conflict as Outstanding">High-stakes</td>
                </tr>
                <tr>
                  <td>üõë Challenges</td>
                  <td data-category="3" data-rating="1" tabindex="0" role="button" aria-label="Rate Challenges as Good">Easy</td>
                  <td data-category="3" data-rating="2" tabindex="0" role="button" aria-label="Rate Challenges as Great">Routine</td>
                  <td data-category="3" data-rating="3" tabindex="0" role="button" aria-label="Rate Challenges as Excellent">Balanced</td>
                  <td data-category="3" data-rating="4" tabindex="0" role="button" aria-label="Rate Challenges as Outstanding">Dynamic</td>
                </tr>
                <tr>
                  <td>üìà Retention</td>
                  <td data-category="4" data-rating="1" tabindex="0" role="button" aria-label="Rate Retention as Good">Boring</td>
                  <td data-category="4" data-rating="2" tabindex="0" role="button" aria-label="Rate Retention as Great">Some peaks</td>
                  <td data-category="4" data-rating="3" tabindex="0" role="button" aria-label="Rate Retention as Excellent">Paced well</td>
                  <td data-category="4" data-rating="4" tabindex="0" role="button" aria-label="Rate Retention as Outstanding">Suspenseful</td>
                </tr>
                <tr>
                  <td>üöÄ Originality</td>
                  <td data-category="5" data-rating="1" tabindex="0" role="button" aria-label="Rate Originality as Good">Clich√©</td>
                  <td data-category="5" data-rating="2" tabindex="0" role="button" aria-label="Rate Originality as Great">Familiar</td>
                  <td data-category="5" data-rating="3" tabindex="0" role="button" aria-label="Rate Originality as Excellent">Distinct</td>
                  <td data-category="5" data-rating="4" tabindex="0" role="button" aria-label="Rate Originality as Outstanding">Innovative</td>
                </tr>
                <tr>
                  <td>üìñ Story</td>
                  <td data-category="6" data-rating="1" tabindex="0" role="button" aria-label="Rate Story as Good">Flat</td>
                  <td data-category="6" data-rating="2" tabindex="0" role="button" aria-label="Rate Story as Great">Basic</td>
                  <td data-category="6" data-rating="3" tabindex="0" role="button" aria-label="Rate Story as Excellent">Engaging</td>
                  <td data-category="6" data-rating="4" tabindex="0" role="button" aria-label="Rate Story as Outstanding">Emotional</td>
                </tr>
                <tr>
                  <td>üé• Feasibility</td>
                  <td data-category="7" data-rating="1" tabindex="0" role="button" aria-label="Rate Feasibility as Good">Unrealistic</td>
                  <td data-category="7" data-rating="2" tabindex="0" role="button" aria-label="Rate Feasibility as Great">Vague</td>
                  <td data-category="7" data-rating="3" tabindex="0" role="button" aria-label="Rate Feasibility as Excellent">Planned</td>
                  <td data-category="7" data-rating="4" tabindex="0" role="button" aria-label="Rate Feasibility as Outstanding">Ready</td>
                </tr>
                <tr>
                  <td>üé® Visuals</td>
                  <td data-category="8" data-rating="1" tabindex="0" role="button" aria-label="Rate Visuals as Good">Dull</td>
                  <td data-category="8" data-rating="2" tabindex="0" role="button" aria-label="Rate Visuals as Great">Average</td>
                  <td data-category="8" data-rating="3" tabindex="0" role="button" aria-label="Rate Visuals as Excellent">Appealing</td>
                  <td data-category="8" data-rating="4" tabindex="0" role="button" aria-label="Rate Visuals as Outstanding">Stunning</td>
                </tr>
              </tbody>
            </table>
          </div>
          <button class="btn" onclick="showTab('feedback')">Next: Get Feedback</button>
        </section>

        <!-- Feedback -->
        <section id="feedback" class="tab glass-panel">
          <h2>üí° Next Steps</h2>
          <div id="feedbackOutput"></div>
          <textarea id="humanFeedback" class="story-input" placeholder="Weakest part? Best twist? Production concerns?"></textarea>
          <button class="btn" onclick="showTab('plan')">Next: Production Plan</button>
        </section>

        <!-- Production Plan -->
        <section id="plan" class="tab glass-panel">
          <h2>üé¨ Production Plan</h2>
          <div id="plannerList"></div>
          <button class="btn" onclick="exportPNG()">Export Plan as PNG</button>
          <button class="btn" onclick="resetAll()">Reset All</button>
        </section>
      </main>

      <!-- Footer -->
      <footer>
        <p>Created by loverfellayt - <a href="https://youtube.com/@yourchannel" target="_blank">Subscribe!</a></p>
      </footer>
    </div>

    <!-- Toast -->
    <div id="toast"></div>

    <!-- JavaScript -->
    <script>
      let scores = {};

      window.addEventListener('DOMContentLoaded', () => {
        // Load saved state
        const savedScores = JSON.parse(localStorage.getItem('scores') || '{}');
        scores = savedScores;
        Object.entries(scores).forEach(([cat, rating]) => {
          const cell = document.querySelector(`td[data-category="${cat}"][data-rating="${rating}"]`);
          if (cell) cell.classList.add('selected');
        });
        document.getElementById('quickSummary').value = localStorage.getItem('quickSummary') || '';
        document.getElementById('humanFeedback').value = localStorage.getItem('humanFeedback') || '';
        updateWordCount();

        // Event Listeners
        document.getElementById('quickSummary').addEventListener('input', () => {
          localStorage.setItem('quickSummary', document.getElementById('quickSummary').value);
          updateWordCount();
          autoResize({ target: document.getElementById('quickSummary') });
        });
        document.getElementById('humanFeedback').addEventListener('input', () => {
          localStorage.setItem('humanFeedback', document.getElementById('humanFeedback').value);
          autoResize({ target: document.getElementById('humanFeedback') });
        });

        document.querySelectorAll('.modern-table td[data-rating]').forEach(cell => {
          cell.addEventListener('click', () => selectRating(cell));
          cell.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              selectRating(cell);
            }
          });
        });

        // Show initial tab
        showTab('concept');
      });

      function showTab(tabId) {
        document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        document.getElementById(`tab-${tabId}`).classList.add('active');
        if (tabId === 'feedback') updateFeedback();
        if (tabId === 'plan') updatePlanner();
      }

      function selectRating(cell) {
        const categoryIndex = Number(cell.getAttribute('data-category'));
        const rating = parseInt(cell.getAttribute('data-rating'));
        const row = cell.parentElement;
        row.querySelectorAll('td').forEach(td => {
          if (td !== row.firstElementChild) td.classList.remove('selected');
        });
        cell.classList.add('selected');
        scores[categoryIndex] = rating;
        localStorage.setItem('scores', JSON.stringify(scores));
      }

      function updateWordCount() {
        const text = document.getElementById('quickSummary').value;
        const wordCount = text.split(/\s+/).filter(word => word.length > 0).length;
        document.getElementById('wordCount').textContent = wordCount;
      }

      function autoResize(e) {
        const textarea = e.target;
        textarea.style.height = 'auto';
        textarea.style.height = `${textarea.scrollHeight}px`;
      }

      function updateFeedback() {
        const feedback = [];
        if ((scores[0] || 0) < 3) feedback.push("Hook: Add a surprising stat, question, or action in the first 10 seconds.");
        if ((scores[1] || 0) < 3) feedback.push("Goal: Clarify what you‚Äôre aiming for‚Äîmake it specific and exciting.");
        if ((scores[2] || 0) < 3) feedback.push("Conflict: Raise stakes with a bigger obstacle or time limit.");
        if ((scores[3] || 0) < 3) feedback.push("Challenges: Add unique or unexpected hurdles to overcome.");
        if ((scores[4] || 0) < 3) feedback.push("Retention: Plan peaks every 30 seconds‚Äîcuts, reveals, or twists.");
        if ((scores[5] || 0) < 3) feedback.push("Originality: Twist a trend or combine two ideas for a fresh angle.");
        if ((scores[6] || 0) < 3) feedback.push("Story: Deepen emotional stakes‚Äîwhy should viewers care?");
        if ((scores[7] || 0) < 3) feedback.push("Feasibility: List resources needed to make this doable.");
        if ((scores[8] || 0) < 3) feedback.push("Visuals: Add bold colors, effects, or Roblox assets to pop.");
        document.getElementById('feedbackOutput').innerHTML = `<ul>${feedback.map(item => `<li>${item}</li>`).join('') || '<li>Your concept looks solid‚Äîready to plan!</li>'}</ul>`;
      }

      function updatePlanner() {
        const summary = document.getElementById('quickSummary').value.toLowerCase();
        const planner = [
          "Script your hook scene (first 10-15 seconds).",
          summary.includes('roblox') ? "Set up Roblox Studio with required assets." : "Gather filming equipment (camera, mic, etc.).",
          (scores[2] || 0) < 3 ? "Plan a key conflict moment (e.g., mid-video escalation)." : "Reinforce your conflict scene with timing.",
          (scores[7] || 0) < 3 ? "List props, locations, or tools needed." : "Confirm all resources are ready (e.g., props, software).",
          "Schedule 2-3 retention peaks (e.g., reveals, cuts, surprises).",
          (scores[8] || 0) < 3 ? "Design a standout visual (e.g., effect, thumbnail idea)." : "Polish your visual hook for impact.",
          "Write a call-to-action for the ending (e.g., like, subscribe)."
        ];
        document.getElementById('plannerList').innerHTML = `<ul>${planner.map(item => `<li>${item}</li>`).join('')}</ul>`;
      }

      async function exportPNG() {
        showToast('Exporting... Please wait.');
        const tempContainer = document.createElement('div');
        tempContainer.style.background = getComputedStyle(document.documentElement).getPropertyValue('--bg-light');
        tempContainer.style.padding = '2rem';
        tempContainer.style.fontFamily = 'Poppins, sans-serif';
        tempContainer.style.color = getComputedStyle(document.documentElement).getPropertyValue('--text-light');
        tempContainer.innerHTML = `
          <h1 style="text-align: center; color: var(--highlight); font-size: 2rem;">StoryCraft Video Plan</h1>
          <h2 style="color: var(--primary-light);">Concept</h2>
          <p>${document.getElementById('quickSummary').value || 'No concept entered yet.'}</p>
          <h2 style="color: var(--primary-light);">Feedback</h2>
          ${document.getElementById('feedbackOutput').innerHTML}
          <h2 style="color: var(--primary-light);">Production Plan</h2>
          ${document.getElementById('plannerList').innerHTML}
          <h2 style="color: var(--primary-light);">Notes</h2>
          <p>${document.getElementById('humanFeedback').value || 'No notes added.'}</p>
        `;
        document.body.appendChild(tempContainer);

        try {
          const canvas = await html2canvas(tempContainer, { scale: 2 });
          const dataUrl = canvas.toDataURL('image/png');
          const link = document.createElement('a');
          link.download = 'storycraft-video-plan.png';
          link.href = dataUrl;
          link.click();
          showToast('Plan exported successfully!');
        } catch (error) {
          console.error('PNG export failed:', error);
          showToast('Export failed! Check console.', 3000);
        } finally {
          document.body.removeChild(tempContainer);
        }
      }

      function resetAll() {
        scores = {};
        document.querySelectorAll('.selected').forEach(cell => cell.classList.remove('selected'));
        document.getElementById('quickSummary').value = '';
        document.getElementById('humanFeedback').value = '';
        localStorage.clear();
        updateWordCount();
        showTab('concept');
        showToast('All data reset!');
      }

      function showToast(message, duration = 2000) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.style.display = 'block';
        setTimeout(() => toast.style.display = 'none', duration);
      }
    </script>
  </body>
</html>
