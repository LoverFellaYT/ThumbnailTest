<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editing Review Pro+ (Unified Table)</title>

    <!-- Font Awesome for editing icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnH/PRRZ9i6Lkxy/lK+Ad+Qw3PweIIsXgTn5N2sA3ZgP6L6YKn42pPZLNSQNkI3b7HlFj5pAg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- Roboto Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <!-- html2canvas for PNG Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Canvas Confetti for Outstanding Score Effect -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>

    <style>
      /* CSS Variables & Base Styles */
      :root {
        --primary-light: #4facfe;
        --accent-light: #00f2fe;
        --bg-light: #f9fafb;
        --text-light: #1e293b;
        --panel-light: rgba(255, 255, 255, 0.96);
        --border-light: rgba(255, 255, 255, 0.2);
        --shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
        --transition: all 0.2s ease;
        --radius: 14px;
        --gradient-light: linear-gradient(135deg, var(--primary-light) 0%, var(--accent-light) 100%);
        --spacing: 1rem;
        --font-base: 'Roboto', sans-serif;
        --table-cell-bg-light: rgba(255, 255, 255, 0.85);
      }

      /* Dark Mode Variables */
      html[data-theme="dark"] {
        --bg-light: #1f1f1f;
        --text-light: #f3f3f3;
        --panel-light: rgba(18, 18, 18, 0.98);
        --border-light: rgba(255, 255, 255, 0.2);
        --gradient-light: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        --table-cell-bg-light: rgba(30, 30, 30, 0.85);
      }

      /* Base styles */
      body {
        margin: 0;
        padding: 0;
        font-family: var(--font-base);
        background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px), var(--bg-light);
        background-size: 30px 30px;
        color: var(--text-light);
        transition: var(--transition);
      }

      button:focus,
      [tabindex]:focus {
        outline: 2px solid var(--accent-light);
      }

      /* Panels */
      .glass-panel {
        background: var(--panel-light);
        border: 1px solid var(--border-light);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        backdrop-filter: blur(12px);
        padding: var(--spacing);
        margin-bottom: var(--spacing);
      }

      /* HEADER */
      header.analyzer-header {
        position: sticky;
        top: 0;
        z-index: 2000;
        padding: 1.5rem 2rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .header-left {
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
      }

      .site-title {
        font-size: 1.8rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .site-title i {
        color: var(--accent-light);
      }

      .total-score {
        font-size: 1.2rem;
        font-weight: 600;
        background: var(--gradient-light);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        position: relative;
        cursor: default;
        transition: var(--transition);
      }
      .total-score:hover::after {
        content: "Overall (0/84)";
        position: absolute;
        background: rgba(0, 0, 0, 0.8);
        color: #fff;
        padding: 0.5rem;
        border-radius: 4px;
        top: 110%;
        left: 0;
        white-space: pre-line;
        font-size: 0.85rem;
        z-index: 1000;
      }
      .status-indicator {
        font-weight: 600;
      }
      .header-right {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
      }
      .header-right .group {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .btn {
        background: var(--gradient-light);
        color: #fff;
        border: none;
        padding: 0.6rem 1.2rem;
        border-radius: var(--radius);
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        box-shadow: 0 4px 6px rgba(126, 34, 206, 0.2);
      }
      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(126, 34, 206, 0.4);
      }

      /* Dark Mode Slider */
      .dark-mode { }
      .toggle-label.dark-mode-label {
        cursor: pointer;
        display: inline-flex;
        align-items: center;
      }
      .dark-mode-slider {
        position: relative;
        width: 60px;
        height: 30px;
        background-color: #e0e0e0;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 5px;
        transition: background-color 0.3s;
      }
      .dark-mode-slider .mode-label {
        font-size: 16px;
      }
      .dark-mode-slider .slider-thumb {
        position: absolute;
        width: 26px;
        height: 26px;
        background: white;
        border-radius: 50%;
        top: 2px;
        left: 2px;
        transition: transform 0.3s;
      }
      input#darkModeToggle { display: none; }
      input#darkModeToggle:checked + .dark-mode-slider .slider-thumb {
        transform: translateX(30px);
      }
      input#darkModeToggle:checked + .dark-mode-slider {
        background-color: var(--primary-light);
      }

      /* Quote Section (Top) */
      .quote-section {
        text-align: center;
        margin: 1rem auto;
        font-style: italic;
        padding: 0.5rem;
        background: var(--panel-light);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        animation: fadeIn 0.8s ease-in-out;
        max-width: 800px;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
      }

      /* Main Content */
      main {
        margin: var(--spacing) auto;
      }
      .analyzer-container {
        width: 95%;
        max-width: 1400px;
        margin: 2rem auto;
        padding: 0 var(--spacing) 2rem;
      }

      /* Rubric Table */
      .rubric-table {
        margin-bottom: var(--spacing);
        overflow-x: auto;
      }
      .modern-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        font-family: var(--font-base);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: var(--radius);
        overflow: hidden;
        transition: var(--transition);
      }
      .modern-table thead th {
        padding: 0.75rem 1.5rem;
        font-weight: 600;
        position: sticky;
        top: 0;
        backdrop-filter: blur(10px);
        z-index: 10;
        text-align: left;
      }
      /* Revert to the original table header colors */
      .modern-table thead th:first-child {
        background: var(--gradient-light);
        color: #fff;
      }
      .modern-table thead th:nth-child(2) {
        background: #f87171;
        color: #fff;
      }
      .modern-table thead th:nth-child(3) {
        background: #fb923c;
        color: #fff;
      }
      .modern-table thead th:nth-child(4) {
        background: #facc15;
        color: #fff;
      }
      .modern-table thead th:nth-child(5) {
        background: #4ade80;
        color: #fff;
      }

      .modern-table tbody td {
        padding: 0.75rem 1.5rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        transition: var(--transition);
        vertical-align: top;
        cursor: pointer;
        background: var(--table-cell-bg-light);
      }
      .modern-table tbody td:hover {
        transform: scale(1.01);
        background-color: rgba(224, 231, 255, 0.3);
      }
      .modern-table tbody tr:hover td {
        background-color: rgba(0, 0, 0, 0.03);
      }
      .modern-table td.selected {
        background: rgba(224, 231, 255, 0.5) !important;
        box-shadow: inset 4px 0 0 var(--primary-light);
      }

      .category-header {
        font-weight: normal;
      }

      /* Section header for groups (title in bold, score in regular).
         Default state is white background with label "Incomplete". */
      .section-header {
        background: white;
        color: #000;
        text-align: center;
        font-size: 1.1rem;
        cursor: pointer;
        transition: background-color 0.5s ease;
      }
      tr.collapsed {
        opacity: 0;
        pointer-events: none;
        height: 0px;
        transition: all 0.3s ease;
      }
      tr.collapsed td {
        padding-top: 0 !important;
        padding-bottom: 0 !important;
        border: 0 !important;
        line-height: 0 !important;
      }

      /* Feedback Panel */
      .feedback-panel h3 { margin-top: 0; }
      .feedback-panel .feedback-entry { margin-bottom: var(--spacing); }
      .feedback-panel label {
        font-weight: 600;
        display: block;
        margin-bottom: 0.3rem;
      }
      .feedback-input {
        display: block;
        width: 100%;
        max-width: 600px;
        box-sizing: border-box;
        min-height: 80px;
        padding: var(--spacing);
        border: 2px solid #e2e8f0;
        border-radius: var(--radius);
        font-size: 1rem;
        transition: var(--transition);
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow: auto;
      }
      .feedback-input:focus {
        outline: none;
        border-color: var(--primary-light);
        box-shadow: 0 0 0 3px rgba(126, 34, 206, 0.2);
      }
      .feedback-input:empty::before {
        content: attr(data-placeholder);
        color: #9ca3af;
      }

      /* Legend & Definitions */
      #toggleLegend {
        margin: var(--spacing) 0;
        padding: 0.4rem 0.8rem;
        background: var(--gradient-light);
        color: #fff;
        border: none;
        border-radius: var(--radius);
        cursor: pointer;
        transition: var(--transition);
      }
      #toggleLegend:hover { opacity: 0.9; }
      #legend {
        display: none;
        margin-top: 0.5rem;
        font-size: 0.9rem;
        line-height: 1.4;
        background: var(--panel-light);
        border: 1px solid var(--border-light);
        border-radius: var(--radius);
        padding: var(--spacing);
      }
      #legend h4 { margin-top: 0; }

      /* Review Checklist Section */
      .review-checklist {
        background: var(--panel-light);
        border: 1px solid var(--border-light);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: var(--spacing);
        margin: 2rem auto 1rem;
        max-width: 800px;
      }
      .review-checklist h3 {
        text-align: center;
        margin-top: 0;
      }
      .review-checklist ul {
        list-style: none;
        padding-left: 0;
      }
      .review-checklist li {
        margin: 0.75rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .review-checklist input[type="checkbox"] {
        transform: scale(1.2);
        cursor: pointer;
      }
      .assessment-result {
        text-align: center;
        font-weight: bold;
        margin-top: var(--spacing);
      }

      /* Fun Fact Section (Bottom) */
      .fun-fact-section {
        text-align: center;
        margin: 1rem auto;
        font-style: italic;
        padding: 0.5rem;
        background: var(--panel-light);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        animation: fadeIn 0.8s ease-in-out;
        max-width: 800px;
      }

      /* Disney Magic Easter Egg Icon */
      #disneyMagic {
        position: fixed;
        bottom: 10px;
        right: 10px;
        cursor: pointer;
        font-size: 2em;
        z-index: 10000;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
      }

      /* Modal Styles – Using semantic <dialog> for better accessibility */
      .modal-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        padding: var(--spacing);
      }
      .modal-bg.show {
        display: flex;
        animation: fadeIn 0.3s ease-in-out;
      }
      .modal-content {
        position: relative;
        background: #fff;
        border-radius: var(--radius);
        max-width: 90%;
        max-height: 90%;
        overflow-y: auto;
        padding: 1.5rem;
      }
      .close-btn {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        cursor: pointer;
      }
      .close-btn:hover {
        background: rgba(255, 255, 255, 1);
      }

      /* Responsive */
      @media (max-width: 992px) {
        .analyzer-container { padding: 0 1rem 2rem; }
      }
    </style>
  </head>
  <body>
    <!-- HEADER -->
    <header class="analyzer-header glass-panel">
      <div class="header-left">
        <div class="site-title">
          <i class="fas fa-film" aria-hidden="true"></i>
          <span>Editing Review Pro+</span>
        </div>
        <div class="total-score" id="scoreDisplay" tabindex="0">
          Overall (<span id="scoreTotal">0</span>/84) – <span id="scoreLabel">Needs Work</span>
        </div>
        <div class="status-indicator" id="ranking" aria-live="polite">Incomplete</div>
      </div>
      <div class="header-right">
        <div class="group">
          <button class="btn" onclick="resetScores()" aria-label="Reset Scores">🔄 Reset</button>
          <button class="btn" onclick="exportPNG()" aria-label="Export as PNG">🖼️ Export PNG</button>
          <button class="btn" onclick="openHowTo()" aria-label="How To Use">❓ How To</button>
          <!-- Renamed 'Rubrics' to 'Home' -->
          <button class="btn" onclick="window.open('https://loverfellayt.github.io/ThumbnailTest/my-video-rubrics#rubrics','_blank');" aria-label="Home">
            <i class="fas fa-home"></i> Home
          </button>
        </div>
        <!-- Dark Mode Toggle -->
        <div class="dark-mode">
          <label class="toggle-label dark-mode-label" for="darkModeToggle">
            <input type="checkbox" id="darkModeToggle" onchange="toggleTheme(this)" aria-label="Toggle Dark Mode" />
            <div class="dark-mode-slider">
              <span class="mode-label mode-light">☀️</span>
              <span class="mode-label mode-dark">🌙</span>
              <div class="slider-thumb"></div>
            </div>
          </label>
        </div>
      </div>
    </header>

    <!-- QUOTE OF WISDOM SECTION (Top) -->
    <div class="quote-section glass-panel" id="quoteSection" role="note" aria-live="polite">
      <!-- A random inspirational quote will appear here -->
    </div>

    <main>
      <div class="analyzer-container">
        <!-- Rubric Table -->
        <section class="rubric-table glass-panel" aria-labelledby="masterRubricHeading">
          <h2 id="masterRubricHeading">Editing Review Rubric</h2>
          <table class="modern-table" id="masterTable">
            <thead>
              <tr>
                <th>Category</th>
                <th>Needs Improvement</th>
                <th>Fair</th>
                <th>Good</th>
                <th>Outstanding</th>
              </tr>
            </thead>
            <tbody>
              <!-- Group 1: Hook & Opening Impact -->
              <tr class="section-header" data-group="g1">
                <td colspan="5">Hook &amp; Opening Impact</td>
              </tr>
              <tr data-group="g1">
                <td data-category="0" class="category-header"><strong>Immediate Intrigue (first 5–15s)</strong></td>
                <td data-category="0" data-rating="1">Slow or generic start; fails to grab attention</td>
                <td data-category="0" data-rating="2">Some intrigue but not strong enough to truly hook viewers</td>
                <td data-category="0" data-rating="3">Quickly piques interest; viewers have a clear reason to keep watching</td>
                <td data-category="0" data-rating="4">Electrifying opener that instantly captivates</td>
              </tr>
              <tr data-group="g1">
                <td data-category="1" class="category-header"><strong>Premise Clarity &amp; Alignment</strong></td>
                <td data-category="1" data-rating="1">Unclear or misleading about the video’s purpose</td>
                <td data-category="1" data-rating="2">Somewhat explains the purpose but may feel vague</td>
                <td data-category="1" data-rating="3">Clearly states or shows the main challenge/topic</td>
                <td data-category="1" data-rating="4">Immediately shows the exact premise promised in the title</td>
              </tr>
              <tr data-group="g1">
                <td data-category="2" class="category-header"><strong>Unique Hook/Twist</strong></td>
                <td data-category="2" data-rating="1">No special twist; feels standard with nothing new</td>
                <td data-category="2" data-rating="2">Hints at something different but not boldly shown</td>
                <td data-category="2" data-rating="3">Reveals a unique challenge/angle early enough</td>
                <td data-category="2" data-rating="4">Showcases the special rule/twist right away</td>
              </tr>

              <!-- Group 2: Pacing & Momentum -->
              <tr class="section-header" data-group="g2">
                <td colspan="5">Pacing &amp; Momentum</td>
              </tr>
              <tr data-group="g2">
                <td data-category="3" class="category-header"><strong>Energy &amp; Speed</strong></td>
                <td data-category="3" data-rating="1">Sluggish pacing; dull segments that make viewers tune out</td>
                <td data-category="3" data-rating="2">Some energetic moments but also slow spots</td>
                <td data-category="3" data-rating="3">Steady, lively pace with few dead zones</td>
                <td data-category="3" data-rating="4">Rapid‑fire editing, high energy from start</td>
              </tr>
              <tr data-group="g2">
                <td data-category="4" class="category-header"><strong>Conciseness (No Fluff)</strong></td>
                <td data-category="4" data-rating="1">Bloated with unnecessary monologues or filler</td>
                <td data-category="4" data-rating="2">Intro is okay length but could cut some fluff</td>
                <td data-category="4" data-rating="3">Fairly tight with minimal repetition</td>
                <td data-category="4" data-rating="4">Ultra‑concise; no wasted time</td>
              </tr>
              <tr data-group="g2">
                <td data-category="5" class="category-header"><strong>Progression &amp; Urgency</strong></td>
                <td data-category="5" data-rating="1">Feels static, no sense of moving toward main content</td>
                <td data-category="5" data-rating="2">Occasional forward push but somewhat meandering</td>
                <td data-category="5" data-rating="3">Solid momentum; transitions quickly</td>
                <td data-category="5" data-rating="4">Constant "go, go, go"; propels viewers forward</td>
              </tr>

              <!-- Group 3: Transitions & Flow -->
              <tr class="section-header" data-group="g3">
                <td colspan="5">Transitions &amp; Flow</td>
              </tr>
              <tr data-group="g3">
                <td data-category="6" class="category-header"><strong>Smooth Scene Changes</strong></td>
                <td data-category="6" data-rating="1">Abrupt, jarring cuts that disrupt viewing</td>
                <td data-category="6" data-rating="2">Mostly coherent transitions but a few rough spots</td>
                <td data-category="6" data-rating="3">Smooth cuts that feel natural</td>
                <td data-category="6" data-rating="4">Seamless changes timed for max impact</td>
              </tr>
              <tr data-group="g3">
                <td data-category="7" class="category-header"><strong>Visual Continuity</strong></td>
                <td data-category="7" data-rating="1">Disconnected footage or random jumps</td>
                <td data-category="7" data-rating="2">Generally logical sequence but occasional confusion</td>
                <td data-category="7" data-rating="3">Clear, logical flow; easy to follow</td>
                <td data-category="7" data-rating="4">Never feels lost—masterful transitions</td>
              </tr>
              <tr data-group="g3">
                <td data-category="8" class="category-header"><strong>Timing &amp; Beat Matching</strong></td>
                <td data-category="8" data-rating="1">Mistimed edits that clash with audio/action</td>
                <td data-category="8" data-rating="2">Some alignment with music/action but not always</td>
                <td data-category="8" data-rating="3">Good synchronization; cuts hit on beats</td>
                <td data-category="8" data-rating="4">Exceptional timing—perfectly synced</td>
              </tr>

              <!-- Group 4: Visual Engagement & Graphics -->
              <tr class="section-header" data-group="g4">
                <td colspan="5">Visual Engagement &amp; Graphics</td>
              </tr>
              <tr data-group="g4">
                <td data-category="9" class="category-header"><strong>On‑Screen Text &amp; Graphics</strong></td>
                <td data-category="9" data-rating="1">Little or cluttered text; hard to read</td>
                <td data-category="9" data-rating="2">Basic overlays but underutilized or inconsistent</td>
                <td data-category="9" data-rating="3">Clear text/graphics reinforcing key points</td>
                <td data-category="9" data-rating="4">Dynamic elements that are visually striking</td>
              </tr>
              <tr data-group="g4">
                <td data-category="10" class="category-header"><strong>B‑Roll &amp; Cutaways</strong></td>
                <td data-category="10" data-rating="1">No supplementary visuals; monotony</td>
                <td data-category="10" data-rating="2">Limited variety; occasional cutaway</td>
                <td data-category="10" data-rating="3">Good mix of main footage &amp; extra visuals</td>
                <td data-category="10" data-rating="4">Skillful use of cutaways for lively visuals</td>
              </tr>
              <tr data-group="g4">
                <td data-category="11" class="category-header"><strong>Camera Movement &amp; Zooms</strong></td>
                <td data-category="11" data-rating="1">Static; misses emphasis opportunities</td>
                <td data-category="11" data-rating="2">Some camera moves but lack impact</td>
                <td data-category="11" data-rating="3">Effective zooms highlight reactions</td>
                <td data-category="11" data-rating="4">Expertly timed moves that heighten drama</td>
              </tr>

              <!-- Group 5: Audio – Music &amp; Sound Design -->
              <tr class="section-header" data-group="g5">
                <td colspan="5">Audio – Music &amp; Sound Design</td>
              </tr>
              <tr data-group="g5">
                <td data-category="12" class="category-header"><strong>Emotional Cues (Faces &amp; Reactions)</strong></td>
                <td data-category="12" data-rating="1">No human/emotional element</td>
                <td data-category="12" data-rating="2">Occasional facecam but misses prime chances</td>
                <td data-category="12" data-rating="3">Good emphasis on reactions for connection</td>
                <td data-category="12" data-rating="4">Amplifies strong emotional moments consistently</td>
              </tr>
              <tr data-group="g5">
                <td data-category="13" class="category-header"><strong>Music Choice &amp; Impact</strong></td>
                <td data-category="13" data-rating="1">Unfitting track or poor volume levels</td>
                <td data-category="13" data-rating="2">Music is okay but not fully aligned</td>
                <td data-category="13" data-rating="3">Well‑chosen track complements excitement</td>
                <td data-category="13" data-rating="4">Perfectly matched music that energizes</td>
              </tr>
              <tr data-group="g5">
                <td data-category="14" class="category-header"><strong>Sound Effects &amp; Highlights</strong></td>
                <td data-category="14" data-rating="1">No SFX or random overuse of annoying sounds</td>
                <td data-category="14" data-rating="2">Minimal SFX usage; occasionally adds flair</td>
                <td data-category="14" data-rating="3">Fitting SFX to boost excitement or humor</td>
                <td data-category="14" data-rating="4">Masterful SFX that punctuate action</td>
              </tr>

              <!-- Group 6: Retention Techniques -->
              <tr class="section-header" data-group="g6">
                <td colspan="5">Retention Techniques</td>
              </tr>
              <tr data-group="g6">
                <td data-category="15" class="category-header"><strong>Audio Clarity &amp; Mixing</strong></td>
                <td data-category="15" data-rating="1">Muffled commentary or overshadowed voice</td>
                <td data-category="15" data-rating="2">Some clarity issues but mostly understandable</td>
                <td data-category="15" data-rating="3">Clear commentary, balanced with music</td>
                <td data-category="15" data-rating="4">Crystal‑clear voice track, polished levels</td>
              </tr>
              <tr data-group="g6">
                <td data-category="16" class="category-header"><strong>Pattern Interrupts &amp; Variety</strong></td>
                <td data-category="16" data-rating="1">Stays same throughout; becomes dull</td>
                <td data-category="16" data-rating="2">Some variety but large repetitive sections</td>
                <td data-category="16" data-rating="3">Regular interrupts keep viewers engaged</td>
                <td data-category="16" data-rating="4">Constant creativity; watchers never tune out</td>
              </tr>
              <tr data-group="g6">
                <td data-category="17" class="category-header"><strong>Teasers / Open Loops</strong></td>
                <td data-category="17" data-rating="1">No hint of upcoming highlights</td>
                <td data-category="17" data-rating="2">Brief mention of future events but not enticing</td>
                <td data-category="17" data-rating="3">Teases big moments or end challenges</td>
                <td data-category="17" data-rating="4">Perfectly timed glimpse of major payoff</td>
              </tr>

              <!-- Group 7: Overall Engagement & Polish -->
              <tr class="section-header" data-group="g7">
                <td colspan="5">Overall Engagement &amp; Polish</td>
              </tr>
              <tr data-group="g7">
                <td data-category="18" class="category-header"><strong>Surprise &amp; Unpredictability</strong></td>
                <td data-category="18" data-rating="1">Predictable format; no unexpected edits</td>
                <td data-category="18" data-rating="2">Mild surprises but nothing stands out</td>
                <td data-category="18" data-rating="3">Fun or shocking elements keep it fresh</td>
                <td data-category="18" data-rating="4">Packed with unexpected jokes or effects</td>
              </tr>
              <tr data-group="g7">
                <td data-category="19" class="category-header"><strong>Retention Potential</strong></td>
                <td data-category="19" data-rating="1">Likely to lose many viewers early</td>
                <td data-category="19" data-rating="2">Some might stay but no strong reason</td>
                <td data-category="19" data-rating="3">Good chance of retaining watchers</td>
                <td data-category="19" data-rating="4">Almost impossible to click away</td>
              </tr>
              <tr data-group="g7">
                <td data-category="20" class="category-header"><strong>Tone &amp; Style Fit</strong></td>
                <td data-category="20" data-rating="1">Doesn’t match channel vibe; feels off‑brand</td>
                <td data-category="20" data-rating="2">Somewhat aligned but somewhat inconsistent</td>
                <td data-category="20" data-rating="3">Feels suitable for YouTube gaming style</td>
                <td data-category="20" data-rating="4">Perfectly nails the vibe &amp; channel identity</td>
              </tr>
              <tr data-group="g7">
                <td data-category="21" class="category-header"><strong>Technical Quality (Editing &amp; Polish)</strong></td>
                <td data-category="21" data-rating="1">Notable errors/glitches that undermine quality</td>
                <td data-category="21" data-rating="2">Mostly fine but minor polish issues</td>
                <td data-category="21" data-rating="3">Clean, professional editing with no major distractions</td>
                <td data-category="21" data-rating="4">Impeccably edited; exudes top‑tier production</td>
              </tr>
            </tbody>
          </table>

          <button id="toggleLegend" onclick="toggleLegend()">Show Legend &amp; Definitions</button>
          <div id="legend">
            <h4>Legend &amp; Definitions</h4>
            <p><strong>Grouped by Section:</strong></p>
            <ul>
              <li><strong>Hook &amp; Opening Impact (0–2)</strong></li>
              <li><strong>Pacing &amp; Momentum (3–5)</strong></li>
              <li><strong>Transitions &amp; Flow (6–8)</strong></li>
              <li><strong>Visual Engagement &amp; Graphics (9–11)</strong></li>
              <li><strong>Audio – Music &amp; Sound Design (12–14)</strong></li>
              <li><strong>Retention Techniques (15–17)</strong></li>
              <li><strong>Overall Engagement &amp; Polish (18–21)</strong></li>
            </ul>
            <p>Click on a cell in each row that best describes the current level (1–4).</p>
            <h5>Rating Levels</h5>
            <ul>
              <li><strong>Needs Improvement (1):</strong> Major shortcomings.</li>
              <li><strong>Fair (2):</strong> Basic or acceptable.</li>
              <li><strong>Good (3):</strong> Solid quality.</li>
              <li><strong>Outstanding (4):</strong> Perfect performance.</li>
            </ul>
          </div>
        </section>

        <!-- FEEDBACK PANEL -->
        <section class="feedback-panel glass-panel" aria-labelledby="feedbackHeading">
          <h3 id="feedbackHeading">Feedback</h3>
          <div class="feedback-entry">
            <label for="humanFeedback">Human Feedback</label>
            <div id="humanFeedback" class="feedback-input" contenteditable="true" data-placeholder="Enter your human feedback here..." aria-label="Human Feedback"></div>
          </div>
        </section>
      </div>

      <!-- Review Checklist Section -->
      <section class="review-checklist" aria-labelledby="reviewChecklistHeading">
        <h3 id="reviewChecklistHeading">Review Checklist</h3>
        <ul>
          <li>
            <input type="checkbox" id="check1">
            <label for="check1">Does the opening grab attention and set the tone effectively?</label>
          </li>
          <li>
            <input type="checkbox" id="check2">
            <label for="check2">Is the pacing balanced with smooth transitions and clear progression?</label>
          </li>
          <li>
            <input type="checkbox" id="check3">
            <label for="check3">Are visual elements (on‑screen text, graphics, cutaways) clear and engaging?</label>
          </li>
          <li>
            <input type="checkbox" id="check4">
            <label for="check4">Does the audio (music and sound effects) complement the visuals and narrative?</label>
          </li>
          <li>
            <input type="checkbox" id="check5">
            <label for="check5">Is the overall narrative coherent with a strong flow?</label>
          </li>
          <li>
            <input type="checkbox" id="check6">
            <label for="check6">Are creative techniques used effectively to enhance viewer engagement?</label>
          </li>
          <li>
            <input type="checkbox" id="check7">
            <label for="check7">Is the technical quality (editing, resolution, color grading) top‑notch?</label>
          </li>
        </ul>
        <button class="btn" onclick="submitAssessment()">Submit Review Checklist</button>
        <div class="assessment-result" id="assessmentResult" aria-live="polite"></div>
      </section>

      <!-- FUN FACT SECTION (Bottom) -->
      <div class="fun-fact-section glass-panel" id="funFactSection" role="note" aria-live="polite">
        <!-- A random fun fact or tip will appear here -->
      </div>
    </main>

    <!-- HOW-TO MODAL -->
    <dialog class="modal-bg" id="howToModal" aria-labelledby="howToHeading" aria-modal="true">
      <div class="modal-content">
        <button class="close-btn" onclick="closeHowTo()" aria-label="Close How To">&times;</button>
        <h2 id="howToHeading">How to Use Editing Review Pro+</h2>
        <ul>
          <li>Click on the appropriate rating cell for each row in the rubric table.</li>
          <li>Your total score updates automatically (out of 84 maximum points).</li>
          <li>If any item is rated 1, the overall result is "Rejected."</li>
          <li>Read the daily Quote of Wisdom for inspiration.</li>
          <li>Provide additional feedback in the Human Feedback box.</li>
          <li>Use the Review Checklist to evaluate overall quality.</li>
          <li>When finished, you can reset scores or export the review as a PNG.</li>
        </ul>
      </div>
    </dialog>

    <!-- TUTORIAL MODAL -->
    <dialog class="modal-bg" id="tutorialModal" aria-labelledby="tutorialHeading" aria-modal="true">
      <div class="modal-content">
        <button class="close-btn" onclick="closeTutorial()" aria-label="Close Tutorial">&times;</button>
        <div id="tutorialContent"></div>
      </div>
    </dialog>

    <!-- Hidden Audio Elements for Sound Effects -->
    <audio id="victorySound" src="victory.mp3"></audio>
    <audio id="wompSound" src="womp.mp3"></audio>

    <!-- DISNEY MAGIC EASTER EGG ICON -->
    <div id="disneyMagic" title="Click for a little Disney Magic!">✨</div>

    <!-- JAVASCRIPT -->
    <script>
      /***************************************************
       * Global Variables & Emoji Mapping
       ***************************************************/
      let scoreData = {};
      let confettiShown = false;
      const maxCategories = 22;
      const maxPoints = 84;

      const categoryEmojis = {
        0: '⚡',
        1: '🔍',
        2: '🪄',
        3: '🚀',
        4: '✂️',
        5: '⏭️',
        6: '🎞️',
        7: '🧩',
        8: '🎶',
        9: '📝',
        10: '📷',
        11: '🎥',
        12: '💬',
        13: '🎵',
        14: '🔊',
        15: '🎙️',
        16: '📢',
        17: '❓',
        18: '🤯',
        19: '🌀',
        20: '💫',
        21: '💎'
      };

      // Returns the overall rating label and color for overall score
      function getRatingLabel(overallTotal) {
        if (overallTotal < 25) {
          return { scoreLabel: "Needs Work", rankingText: "Needs Work 🔴", color: "#ef4444" };
        } else if (overallTotal < 50) {
          return { scoreLabel: "Good", rankingText: "Good 🟢", color: "#22c55e" };
        } else if (overallTotal < 70) {
          return { scoreLabel: "Great", rankingText: "Great 🟡", color: "#eab308" };
        } else if (overallTotal < 80) {
          return { scoreLabel: "Excellent", rankingText: "Excellent 🟣", color: "#8b5cf6" };
        } else {
          return { scoreLabel: "Outstanding", rankingText: "Outstanding 🔵", color: "#3b82f6" };
        }
      }

      // Determine section rating based on average rating of the section
      function getSectionRating(average) {
        if (average < 2) {
          return { label: "Good", color: "#f87171" };
        } else if (average < 3) {
          return { label: "Great", color: "#fb923c" };
        } else if (average < 4) {
          return { label: "Excellent", color: "#facc15" };
        } else {
          return { label: "Outstanding", color: "#4ade80" };
        }
      }

      // Helper: convert hex color to rgba with given alpha
      function hexToRGBA(hex, alpha) {
        let r = parseInt(hex.slice(1, 3), 16);
        let g = parseInt(hex.slice(3, 5), 16);
        let b = parseInt(hex.slice(5, 7), 16);
        return 'rgba(' + r + ', ' + g + ', ' + b + ', ' + alpha + ')';
      }

      /***************************************************
       * Initialization on DOMContentLoaded
       ***************************************************/
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize scoreData for categories 0 to 21
        for (let i = 0; i < maxCategories; i++) {
          scoreData[i] = 0;
        }
        
        // Add click listeners to all rating cells
        const ratingCells = document.querySelectorAll('td[data-rating]');
        ratingCells.forEach(cell => {
          cell.addEventListener('click', handleCellClick);
        });
        
        // Insert emojis into category header cells
        initEmojis();
        
        // Store original header text for each section header (for later updating with section scores)
        initSectionHeaders();
        
        // Set a random inspirational quote
        randomQuote();
        
        // Set a random fun fact
        randomFunFact();
        
        // Add a click listener to the Disney Magic icon
        document.getElementById('disneyMagic').addEventListener('click', onClickDisneyMagic);
      });

      /***************************************************
       * Event Handlers & UI Functions
       ***************************************************/

      // When a rating cell is clicked:
      function handleCellClick(event) {
        const cell = event.currentTarget;
        const category = cell.getAttribute('data-category');
        const rating = parseInt(cell.getAttribute('data-rating'));

        // Remove 'selected' from other cells in this row
        const row = cell.parentElement;
        const cells = row.querySelectorAll('td[data-rating]');
        cells.forEach(c => c.classList.remove('selected'));

        // Mark this cell as selected and update the scoreData for its category
        cell.classList.add('selected');
        scoreData[category] = rating;

        updateScore();
      }

      // Recalculate and update the overall score and rating display, and update section scores
      function updateScore() {
        let overallTotal = 0;
        for (let key in scoreData) {
          overallTotal += parseInt(scoreData[key]) || 0;
        }
        document.getElementById('scoreTotal').innerText = overallTotal;

        const ratingInfo = getRatingLabel(overallTotal);
        document.getElementById('scoreLabel').innerText = ratingInfo.scoreLabel;
        const rankingElem = document.getElementById('ranking');
        rankingElem.innerText = ratingInfo.rankingText;
        rankingElem.style.color = ratingInfo.color;

        // Update section scores and header backgrounds
        updateSectionScores();

        // If overall score >= 80 and not already celebrated, launch confetti and play a sound
        if (overallTotal >= 80 && !confettiShown) {
          launchConfetti();
          const victorySound = document.getElementById('victorySound');
          if (victorySound) {
            victorySound.play().catch(() => {});
          }
          confettiShown = true;
        } else if (overallTotal < 80) {
          confettiShown = false;
        }
      }

      // Clear all selections and reset the score
      function resetScores() {
        for (let i = 0; i < maxCategories; i++) {
          scoreData[i] = 0;
        }
        const ratingCells = document.querySelectorAll('td[data-rating]');
        ratingCells.forEach(cell => cell.classList.remove('selected'));
        updateScore();

        const wompSound = document.getElementById('wompSound');
        if (wompSound) {
          wompSound.play().catch(() => {});
        }
      }

      // Export the review section as a PNG image using html2canvas
      function exportPNG() {
        const container = document.querySelector('.analyzer-container');
        if (!container) return;
        html2canvas(container).then(canvas => {
          const link = document.createElement('a');
          link.download = 'editing-review.png';
          link.href = canvas.toDataURL();
          link.click();
        }).catch(err => {
          console.error('Error exporting PNG:', err);
        });
      }

      // Toggle the display of the Legend & Definitions section
      function toggleLegend() {
        const legend = document.getElementById('legend');
        const toggleBtn = document.getElementById('toggleLegend');
        if (legend.style.display === 'block') {
          legend.style.display = 'none';
          toggleBtn.innerText = 'Show Legend & Definitions';
        } else {
          legend.style.display = 'block';
          toggleBtn.innerText = 'Hide Legend & Definitions';
        }
      }

      // Toggle between dark mode and light mode
      function toggleTheme(checkbox) {
        if (checkbox.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
        } else {
          document.documentElement.removeAttribute('data-theme');
        }
      }

      // Open the How-To modal dialog
      function openHowTo() {
        const modal = document.getElementById('howToModal');
        if (modal.showModal) {
          modal.showModal();
        } else {
          modal.style.display = 'flex';
        }
      }

      // Close the How-To modal dialog
      function closeHowTo() {
        const modal = document.getElementById('howToModal');
        if (modal.close) {
          modal.close();
        } else {
          modal.style.display = 'none';
        }
      }

      // Close the Tutorial modal dialog
      function closeTutorial() {
        const modal = document.getElementById('tutorialModal');
        if (modal.close) {
          modal.close();
        } else {
          modal.style.display = 'none';
        }
      }

      // Handle review checklist submission by checking if all items are complete
      function submitAssessment() {
        const checkboxes = document.querySelectorAll('.review-checklist input[type="checkbox"]');
        let allChecked = true;
        checkboxes.forEach(cb => {
          if (!cb.checked) { allChecked = false; }
        });
        const resultElem = document.getElementById('assessmentResult');
        if (allChecked) {
          resultElem.innerText = 'Review Checklist Complete! Great job!';
          resultElem.style.color = 'green';
        } else {
          resultElem.innerText = 'Please complete all items in the review checklist.';
          resultElem.style.color = 'red';
        }
      }

      // Prepend the emoji for each category header based on its data-category attribute
      function initEmojis() {
        const categoryHeaders = document.querySelectorAll('td.category-header');
        categoryHeaders.forEach(cell => {
          const category = cell.getAttribute('data-category');
          const emoji = categoryEmojis[category] || '';
          if (!cell.innerHTML.includes(emoji)) {
            cell.innerHTML = emoji + ' ' + cell.innerHTML;
          }
        });
      }

      // Store the original header text for each section header for later updates
      function initSectionHeaders() {
        const sectionHeaders = document.querySelectorAll('tr.section-header');
        sectionHeaders.forEach(row => {
          const cell = row.querySelector('td');
          cell.dataset.original = cell.innerText.trim();
        });
      }

      // Update each section header to include the section score and update background color.
      // If no ratings are entered (score 0), the header remains white with label "Incomplete".
      function updateSectionScores() {
        const sectionHeaders = document.querySelectorAll('tr.section-header');
        sectionHeaders.forEach(headerRow => {
          const group = headerRow.getAttribute('data-group');
          const groupRows = document.querySelectorAll('tr[data-group="' + group + '"]:not(.section-header)');
          let sectionScore = 0;
          groupRows.forEach(row => {
            const catCell = row.querySelector('td.category-header');
            if (catCell) {
              const cat = catCell.getAttribute('data-category');
              sectionScore += parseInt(scoreData[cat]) || 0;
            }
          });
          const numberOfRows = groupRows.length;
          const maxForSection = numberOfRows * 4;
          let sectionLabel;
          if (sectionScore === 0) {
            sectionLabel = "Incomplete";
            headerRow.style.backgroundColor = "white";
          } else {
            const average = sectionScore / numberOfRows;
            const sectionRating = getSectionRating(average);
            sectionLabel = sectionRating.label;
            headerRow.style.backgroundColor = hexToRGBA(sectionRating.color, 0.3);
          }
          const headerCell = headerRow.querySelector('td');
          headerCell.innerHTML =
            '<strong>' + headerCell.dataset.original + '</strong> ' +
            '<span style="font-weight:normal;">(Score: ' + sectionScore + '/' + maxForSection + ' - ' + sectionLabel + ')</span>';
        });
      }

      // Display a random inspirational quote in the Quote section
      function randomQuote() {
        const quoteSection = document.getElementById('quoteSection');
        const randomIndex = Math.floor(Math.random() * editorQuotes.length);
        quoteSection.innerText = editorQuotes[randomIndex];
      }

      // Display a random fun fact in the Fun Fact section
      function randomFunFact() {
        const funFacts = [
          "Did you know? The first film edit was done by physically cutting and splicing film.",
          "Fun Fact: Walter Murch, a legendary editor, also worked as a sound mixer!",
          "Tip: Sometimes less is more—trim your edits for a tighter story.",
          "Did you know? The famous 'montage' technique was popularized in Soviet cinema.",
          "Editing can change the story. A single cut can evoke deep emotions."
        ];
        const funFactSection = document.getElementById('funFactSection');
        const randomIndex = Math.floor(Math.random() * funFacts.length);
        funFactSection.innerText = funFacts[randomIndex];
      }

      // When the Disney Magic icon is clicked, launch confetti and show an alert
      function onClickDisneyMagic() {
        launchConfetti();
        alert("Disney Magic activated! ✨");
      }

      // Launch confetti using the canvas-confetti library
      function launchConfetti() {
        if (typeof confetti === "function") {
          confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
          });
        }
      }

      // Editor quotes array
      const editorQuotes = [
        "“In film editing, it's not about what you add, it's about what you leave out.” – Walter Murch",
        "“Cutting is rewriting.” – Thelma Schoonmaker",
        "“Editing is where the magic happens.” – Unknown",
        "“Good editing is invisible; great editing is felt.” – Unknown",
        "“In editing, less is often more.” – Unknown",
        "“All our dreams can come true if we have the courage to pursue them.” – Walt Disney",
        "“It's kind of fun to do the impossible.” – Walt Disney",
        "“The past can hurt. But the way I see it, you can either run from it, or learn from it.” – Rafiki, The Lion King",
        "“Cinema is truth at 24 frames per second.” – Jean-Luc Godard",
        "“The secret to film editing is knowing when to cut.” – Unknown",
        "“Every cut tells a story.” – Unknown",
        "“Editing is the craft of transforming raw footage into art.” – Unknown",
        "“A good cut is a silent hero.” – Unknown",
        "“When you're editing, you're not just cutting footage; you're sculpting a story.” – Unknown",
        "“The technique of film editing is to be invisible.” – Walter Murch",
        "“The art of editing is the art of omission.” – Elia Kazan",
        "“I’m convinced that nothing happens in the editing room.” – Francis Ford Coppola",
        "“May your edits be as magical as pixie dust.” – Inspired by Disney",
        "“If you can dream it, you can do it.” – Walt Disney"
      ];
    </script>
  </body>
</html>
